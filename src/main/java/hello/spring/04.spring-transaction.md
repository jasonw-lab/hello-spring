---
title:  Spring Transaction
createTime: 2023/08/01 10:30:00
permalink: /java/spring/spring-transaction/
article: true
#sidebar: false
---

# Spring Transaction概要

## Spring Transactionとは

Spring Transactionは、Springフレームワークが提供するトランザクション管理機能です。データベースやメッセージングシステムなどのリソースに対するトランザクション処理を簡単に実装することができます。宣言的トランザクション管理とプログラム的トランザクション管理の両方をサポートしています。

## 主な機能

### 宣言的トランザクション管理

Spring Frameworkでは、`@Transactional`アノテーションを使用して、メソッドやクラスにトランザクション境界を宣言することができます。

```java
@Service
public class UserService {
    @Autowired
    private UserRepository userRepository;
    
    @Transactional
    public void createUser(User user) {
        userRepository.save(user);
        // 他の操作...
    }
}
```

### プログラム的トランザクション管理

`TransactionTemplate`や`PlatformTransactionManager`を使用して、プログラム的にトランザクションを管理することもできます。

```java
@Service
public class UserService {
    @Autowired
    private TransactionTemplate transactionTemplate;
    
    public void createUser(final User user) {
        transactionTemplate.execute(new TransactionCallbackWithoutResult() {
            @Override
            protected void doInTransactionWithoutResult(TransactionStatus status) {
                userRepository.save(user);
                // 他の操作...
            }
        });
    }
}
```

## トランザクション属性

Spring Transactionでは、以下のようなトランザクション属性を設定することができます：

- **伝播動作（Propagation）**：既存のトランザクションとの関係を定義します
- **分離レベル（Isolation）**：トランザクションの分離レベルを設定します
- **タイムアウト（Timeout）**：トランザクションのタイムアウト時間を設定します
- **読み取り専用（Read-only）**：トランザクションが読み取り専用かどうかを指定します
- **ロールバックルール（Rollback rules）**：どの例外でロールバックするかを指定します

## メリット

- 一貫性のあるトランザクション管理：Spring Transactionは、様々なトランザクションAPIに対して一貫したプログラミングモデルを提供します
- コードの簡素化：宣言的トランザクション管理により、トランザクション管理のコードが大幅に簡素化されます
- 柔軟性：様々なトランザクション属性を設定することで、アプリケーションの要件に合わせたトランザクション管理が可能です

## Reference

- [Spring Transaction Management](https://docs.spring.io/spring-framework/docs/current/reference/html/data-access.html#transaction)